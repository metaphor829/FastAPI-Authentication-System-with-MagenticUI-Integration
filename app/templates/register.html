<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - Magentic-UI</title>
    <link rel="icon" type="image/png" href="/static/favicon.png">
    
    <!-- ‰ΩøÁî®‰∏éÁôªÂΩïÈ°µÈù¢Áõ∏ÂêåÁöÑÊ†∑Âºè -->
    <style>
        /* CSSÂèòÈáè - ‰∏éMagentic-UI‰øùÊåÅ‰∏ÄËá¥ */
        .dark {
            --color-bg-primary: #1a1a1a;
            --color-bg-secondary: #a88da841;
            --color-bg-light: #3a3a3a;
            --color-bg-tertiary: #444444;
            --color-bg-opposite: #edf2f7;
            --color-bg-white: #ffffff;
            --color-bg-dark: #1a1a1a;
            --color-bg-accent: #777777;
            --color-text-primary: #ffffff;
            --color-text-secondary: #e5e5e58f;
            --color-text-accent: #e5e5e5;
            --color-border-primary: #ffffff30;
            --color-border-secondary: #e5e5e530;
            --color-border-accent: #1a1a1a;
            --color-warning-primary: #F6A147;
            --color-text-message: #000000;
            --color-magenta-400: #F2E5F2;
            --color-magenta-700: #EECBEE;
            --color-magenta-800: #BF3AC3;
            --color-magenta-900: #953CA3;
            --color-blue-400: #EDF4FB;
            --color-blue-700: #A0D6FF;
            --color-blue-800: #0078d4;
            --color-blue-900: #0062ad;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--color-bg-primary);
            color: var(--color-text-primary);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(191, 58, 195, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 120, 212, 0.1) 0%, transparent 50%);
        }

        .register-container {
            background: var(--color-bg-light);
            border: 1px solid var(--color-border-primary);
            border-radius: 12px;
            padding: 2rem;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .logo-section {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--color-magenta-800), var(--color-blue-800));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--color-text-secondary);
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--color-text-accent);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--color-bg-primary);
            border: 1px solid var(--color-border-primary);
            border-radius: 8px;
            color: var(--color-text-primary);
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--color-magenta-800);
            box-shadow: 0 0 0 3px rgba(191, 58, 195, 0.1);
        }

        .form-input::placeholder {
            color: var(--color-text-secondary);
        }

        .register-button {
            width: 100%;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, var(--color-magenta-800), var(--color-blue-800));
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 1rem;
        }

        .register-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(191, 58, 195, 0.3);
        }

        .register-button:active {
            transform: translateY(0);
        }

        .register-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .login-link {
            text-align: center;
            margin-top: 1rem;
        }

        .login-link a {
            color: var(--color-magenta-800);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .login-link a:hover {
            text-decoration: underline;
        }

        .error-message {
            background: rgba(246, 161, 71, 0.1);
            border: 1px solid var(--color-warning-primary);
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 1rem;
            color: var(--color-warning-primary);
            font-size: 0.9rem;
            display: none;
        }

        .success-message {
            background: rgba(0, 120, 212, 0.1);
            border: 1px solid var(--color-blue-800);
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 1rem;
            color: var(--color-blue-800);
            font-size: 0.9rem;
            display: none;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .password-requirements {
            background: var(--color-bg-primary);
            border: 1px solid var(--color-border-secondary);
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--color-text-secondary);
        }

        .requirement {
            display: flex;
            align-items: center;
            margin-bottom: 0.25rem;
        }

        .requirement:last-child {
            margin-bottom: 0;
        }

        .requirement.valid {
            color: var(--color-blue-800);
        }

        .requirement.invalid {
            color: var(--color-warning-primary);
        }

        /* ËØ≠Ë®ÄÂàáÊç¢ÊåâÈíÆ */
        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .language-btn {
            background: var(--color-bg-light);
            border: 1px solid var(--color-border-primary);
            border-radius: 8px;
            padding: 8px 12px;
            color: var(--color-text-primary);
            cursor: pointer;
            font-size: 0.9rem;
            margin: 0 2px;
            transition: all 0.2s ease;
        }

        .language-btn:hover {
            background: var(--color-bg-tertiary);
            border-color: var(--color-magenta-800);
        }

        .language-btn.active {
            background: var(--color-magenta-800);
            border-color: var(--color-magenta-800);
            color: white;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 480px) {
            .register-container {
                margin: 1rem;
                padding: 1.5rem;
            }

            .language-switcher {
                top: 10px;
                right: 10px;
            }

            .language-btn {
                padding: 6px 8px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="language-switcher">
        <button class="language-btn active" data-lang="en">EN</button>
        <button class="language-btn" data-lang="zh">‰∏≠</button>
        <button class="language-btn" data-lang="ja">Êó•</button>
    </div>

    <div class="register-container">
        <div class="logo-section">
            <div class="logo">üß† Magentic-UI</div>
            <div class="subtitle" data-i18n="subtitle">Create Your Account</div>
        </div>

        <div id="error-message" class="error-message"></div>
        <div id="success-message" class="success-message"></div>

        <form id="register-form">
            <div class="form-group">
                <label for="username" class="form-label" data-i18n="username_required">Username *</label>
                <input
                    type="text"
                    id="username"
                    name="username"
                    class="form-input"
                    data-i18n-placeholder="username_placeholder"
                    placeholder="Enter username (3-20 characters)"
                    required
                    autocomplete="username"
                    minlength="3"
                    maxlength="20"
                >
            </div>

            <div class="form-group">
                <label for="email" class="form-label" data-i18n="email">Email</label>
                <input
                    type="email"
                    id="email"
                    name="email"
                    class="form-input"
                    data-i18n-placeholder="email_placeholder"
                    placeholder="Enter email address (optional)"
                    autocomplete="email"
                >
            </div>

            <div class="form-group">
                <label for="full_name" class="form-label" data-i18n="full_name">Full Name</label>
                <input
                    type="text"
                    id="full_name"
                    name="full_name"
                    class="form-input"
                    data-i18n-placeholder="full_name_placeholder"
                    placeholder="Enter your full name (optional)"
                    autocomplete="name"
                >
            </div>

            <div class="form-group">
                <label for="password" class="form-label" data-i18n="password_required">Password *</label>
                <input
                    type="password"
                    id="password"
                    name="password"
                    class="form-input"
                    data-i18n-placeholder="password_placeholder"
                    placeholder="Enter your password"
                    required
                    autocomplete="new-password"
                    minlength="8"
                >
                <div class="password-requirements">
                    <div class="requirement" id="req-length" data-i18n="req_length">‚Ä¢ At least 8 characters</div>
                    <div class="requirement" id="req-uppercase" data-i18n="req_uppercase">‚Ä¢ Contains uppercase letter</div>
                    <div class="requirement" id="req-lowercase" data-i18n="req_lowercase">‚Ä¢ Contains lowercase letter</div>
                    <div class="requirement" id="req-number" data-i18n="req_number">‚Ä¢ Contains number</div>
                    <div class="requirement" id="req-special" data-i18n="req_special">‚Ä¢ Contains special character</div>
                </div>
            </div>

            <div class="form-group">
                <label for="confirm_password" class="form-label" data-i18n="confirm_password_required">Confirm Password *</label>
                <input
                    type="password"
                    id="confirm_password"
                    name="confirm_password"
                    class="form-input"
                    data-i18n-placeholder="confirm_password_placeholder"
                    placeholder="Confirm your password"
                    required
                    autocomplete="new-password"
                >
            </div>

            <button type="submit" id="register-button" class="register-button" data-i18n="register_button">
                Sign Up
            </button>
        </form>

        <div class="login-link">
            <a href="/login" data-i18n="login_link">Already have an account? Sign in</a>
        </div>
    </div>

    <script>
        // Â§öËØ≠Ë®ÄÊîØÊåÅ
        const translations = {
            en: {
                title: "Sign Up - Magentic-UI",
                subtitle: "Create Your Account",
                username_required: "Username *",
                username_placeholder: "Enter username (3-20 characters)",
                email: "Email",
                email_placeholder: "Enter email address (optional)",
                full_name: "Full Name",
                full_name_placeholder: "Enter your full name (optional)",
                password_required: "Password *",
                password_placeholder: "Enter your password",
                confirm_password_required: "Confirm Password *",
                confirm_password_placeholder: "Confirm your password",
                req_length: "‚Ä¢ At least 8 characters",
                req_uppercase: "‚Ä¢ Contains uppercase letter",
                req_lowercase: "‚Ä¢ Contains lowercase letter",
                req_number: "‚Ä¢ Contains number",
                req_special: "‚Ä¢ Contains special character",
                register_button: "Sign Up",
                register_button_loading: "Signing up...",
                login_link: "Already have an account? Sign in",
                register_success: "Registration successful! Redirecting to login...",
                username_exists: "Username already exists",
                email_exists: "Email already exists",
                passwords_not_match: "Passwords do not match",
                network_error: "Network error, please try again later"
            },
            zh: {
                title: "Ê≥®ÂÜå - Magentic-UI",
                subtitle: "ÂàõÂª∫ÊÇ®ÁöÑË¥¶Êà∑",
                username_required: "Áî®Êà∑Âêç *",
                username_placeholder: "ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÔºà3-20‰ΩçÂ≠óÁ¨¶Ôºâ",
                email: "ÈÇÆÁÆ±",
                email_placeholder: "ËØ∑ËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄÔºàÂèØÈÄâÔºâ",
                full_name: "ÂßìÂêç",
                full_name_placeholder: "ËØ∑ËæìÂÖ•ÁúüÂÆûÂßìÂêçÔºàÂèØÈÄâÔºâ",
                password_required: "ÂØÜÁ†Å *",
                password_placeholder: "ËØ∑ËæìÂÖ•ÂØÜÁ†Å",
                confirm_password_required: "Á°ÆËÆ§ÂØÜÁ†Å *",
                confirm_password_placeholder: "ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å",
                req_length: "‚Ä¢ Ëá≥Â∞ë8‰∏™Â≠óÁ¨¶",
                req_uppercase: "‚Ä¢ ÂåÖÂê´Â§ßÂÜôÂ≠óÊØç",
                req_lowercase: "‚Ä¢ ÂåÖÂê´Â∞èÂÜôÂ≠óÊØç",
                req_number: "‚Ä¢ ÂåÖÂê´Êï∞Â≠ó",
                req_special: "‚Ä¢ ÂåÖÂê´ÁâπÊÆäÂ≠óÁ¨¶",
                register_button: "Ê≥®ÂÜå",
                register_button_loading: "Ê≥®ÂÜå‰∏≠...",
                login_link: "Â∑≤ÊúâË¥¶Êà∑ÔºüÁ´ãÂç≥ÁôªÂΩï",
                register_success: "Ê≥®ÂÜåÊàêÂäüÔºÅÊ≠£Âú®Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÈù¢...",
                username_exists: "Áî®Êà∑ÂêçÂ∑≤Â≠òÂú®",
                email_exists: "ÈÇÆÁÆ±Â∑≤Â≠òÂú®",
                passwords_not_match: "ÂØÜÁ†Å‰∏çÂåπÈÖç",
                network_error: "ÁΩëÁªúÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï"
            },
            ja: {
                title: "„Çµ„Ç§„É≥„Ç¢„ÉÉ„Éó - Magentic-UI",
                subtitle: "„Ç¢„Ç´„Ç¶„É≥„Éà„Çí‰ΩúÊàê",
                username_required: "„É¶„Éº„Ç∂„ÉºÂêç *",
                username_placeholder: "„É¶„Éº„Ç∂„ÉºÂêç„ÇíÂÖ•ÂäõÔºà3-20ÊñáÂ≠óÔºâ",
                email: "„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ",
                email_placeholder: "„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÇíÂÖ•ÂäõÔºà‰ªªÊÑèÔºâ",
                full_name: "Ê∞èÂêç",
                full_name_placeholder: "Ê∞èÂêç„ÇíÂÖ•ÂäõÔºà‰ªªÊÑèÔºâ",
                password_required: "„Éë„Çπ„ÉØ„Éº„Éâ *",
                password_placeholder: "„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ",
                confirm_password_required: "„Éë„Çπ„ÉØ„Éº„ÉâÁ¢∫Ë™ç *",
                confirm_password_placeholder: "„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÜçÂÖ•Âäõ",
                req_length: "‚Ä¢ 8ÊñáÂ≠ó‰ª•‰∏ä",
                req_uppercase: "‚Ä¢ Â§ßÊñáÂ≠ó„ÇíÂê´„ÇÄ",
                req_lowercase: "‚Ä¢ Â∞èÊñáÂ≠ó„ÇíÂê´„ÇÄ",
                req_number: "‚Ä¢ Êï∞Â≠ó„ÇíÂê´„ÇÄ",
                req_special: "‚Ä¢ ÁâπÊÆäÊñáÂ≠ó„ÇíÂê´„ÇÄ",
                register_button: "„Çµ„Ç§„É≥„Ç¢„ÉÉ„Éó",
                register_button_loading: "„Çµ„Ç§„É≥„Ç¢„ÉÉ„Éó‰∏≠...",
                login_link: "Êó¢„Å´„Ç¢„Ç´„Ç¶„É≥„Éà„Çí„ÅäÊåÅ„Å°„ÅÆÊñπ„ÅØ„Åì„Å°„Çâ",
                register_success: "ÁôªÈå≤ÊàêÂäüÔºÅ„É≠„Ç∞„Ç§„É≥„Éö„Éº„Ç∏„Å´„É™„ÉÄ„Ç§„É¨„ÇØ„Éà‰∏≠...",
                username_exists: "„É¶„Éº„Ç∂„ÉºÂêç„ÅØÊó¢„Å´Â≠òÂú®„Åó„Åæ„Åô",
                email_exists: "„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÅØÊó¢„Å´Â≠òÂú®„Åó„Åæ„Åô",
                passwords_not_match: "„Éë„Çπ„ÉØ„Éº„Éâ„Åå‰∏ÄËá¥„Åó„Åæ„Åõ„Çì",
                network_error: "„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ„Åó„Å∞„Çâ„Åè„Åó„Å¶„Åã„ÇâÂÜçË©¶Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ"
            }
        };

        // ÁèæÂú®„ÅÆË®ÄË™ûÔºà„Éá„Éï„Ç©„É´„Éà„ÅØËã±Ë™ûÔºâ
        let currentLang = localStorage.getItem('preferred_language') || 'en';

        // Ë®ÄË™ûÂàá„ÇäÊõø„ÅàÈñ¢Êï∞
        function switchLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('preferred_language', lang);

            // HTML„ÅÆlangÂ±ûÊÄß„ÇíÊõ¥Êñ∞
            document.documentElement.lang = lang === 'zh' ? 'zh-CN' : lang === 'ja' ? 'ja-JP' : 'en';

            // „Çø„Ç§„Éà„É´„ÇíÊõ¥Êñ∞
            document.title = translations[lang].title;

            // „Åô„Åπ„Å¶„ÅÆÁøªË®≥Ë¶ÅÁ¥†„ÇíÊõ¥Êñ∞
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });

            // „Éó„É¨„Éº„Çπ„Éõ„É´„ÉÄ„Éº„ÇíÊõ¥Êñ∞
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) {
                    element.placeholder = translations[lang][key];
                }
            });

            // Ë®ÄË™û„Éú„Çø„É≥„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„ÇíÊõ¥Êñ∞
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                }
            });
        }

        // Ë®ÄË™û„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.querySelectorAll('.language-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const lang = btn.getAttribute('data-lang');
                switchLanguage(lang);
            });
        });

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´‰øùÂ≠ò„Åï„Çå„ÅüË®ÄË™û„ÇíÈÅ©Áî®
        document.addEventListener('DOMContentLoaded', () => {
            switchLanguage(currentLang);
        });

        // ÂØÜÁ†ÅÂº∫Â∫¶È™åËØÅ
        function validatePassword(password) {
            const requirements = {
                length: password.length >= 8,
                uppercase: /[A-Z]/.test(password),
                lowercase: /[a-z]/.test(password),
                number: /\d/.test(password),
                special: /[!@#$%^&*(),.?":{}|<>]/.test(password)
            };

            // Êõ¥Êñ∞UIÊòæÁ§∫
            Object.keys(requirements).forEach(req => {
                const element = document.getElementById(`req-${req}`);
                if (requirements[req]) {
                    element.classList.remove('invalid');
                    element.classList.add('valid');
                } else {
                    element.classList.remove('valid');
                    element.classList.add('invalid');
                }
            });

            return Object.values(requirements).every(Boolean);
        }

        // ÂØÜÁ†ÅËæìÂÖ•ÁõëÂê¨
        document.getElementById('password').addEventListener('input', (e) => {
            validatePassword(e.target.value);
        });

        // Ê≥®ÂÜåË°®ÂçïÂ§ÑÁêÜ
        document.getElementById('register-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const button = document.getElementById('register-button');
            const errorDiv = document.getElementById('error-message');
            const successDiv = document.getElementById('success-message');
            
            // ÈöêËóè‰πãÂâçÁöÑÊ∂àÊÅØ
            errorDiv.style.display = 'none';
            successDiv.style.display = 'none';
            
            const formData = new FormData(e.target);
            const password = formData.get('password');
            const confirmPassword = formData.get('confirm_password');
            
            // È™åËØÅÂØÜÁ†Å
            if (!validatePassword(password)) {
                errorDiv.textContent = 'ÂØÜÁ†Å‰∏çÁ¨¶ÂêàË¶ÅÊ±ÇÔºåËØ∑Ê£ÄÊü•ÂØÜÁ†ÅÂº∫Â∫¶';
                errorDiv.style.display = 'block';
                return;
            }
            
            if (password !== confirmPassword) {
                errorDiv.textContent = translations[currentLang].passwords_not_match;
                errorDiv.style.display = 'block';
                return;
            }

            // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
            button.disabled = true;
            button.innerHTML = '<span class="loading"></span>' + translations[currentLang].register_button_loading;

            try {
                const registerData = {
                    username: formData.get('username'),
                    email: formData.get('email') || null,
                    full_name: formData.get('full_name') || null,
                    password: password
                };
                
                const response = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(registerData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Ê≥®ÂÜåÊàêÂäü
                    successDiv.textContent = translations[currentLang].register_success;
                    successDiv.style.display = 'block';

                    // Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÈù¢
                    setTimeout(() => {
                        window.location.href = '/login';
                    }, 2000);
                } else {
                    // Ê≥®ÂÜåÂ§±Ë¥•
                    let errorMessage = data.detail || 'Registration failed, please try again';
                    if (data.detail && data.detail.includes('Áî®Êà∑ÂêçÂ∑≤Â≠òÂú®') || data.detail && data.detail.includes('Username already exists')) {
                        errorMessage = translations[currentLang].username_exists;
                    } else if (data.detail && data.detail.includes('ÈÇÆÁÆ±Â∑≤Â≠òÂú®') || data.detail && data.detail.includes('Email already exists')) {
                        errorMessage = translations[currentLang].email_exists;
                    }
                    errorDiv.textContent = errorMessage;
                    errorDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Register error:', error);
                errorDiv.textContent = translations[currentLang].network_error;
                errorDiv.style.display = 'block';
            } finally {
                // ÊÅ¢Â§çÊåâÈíÆÁä∂ÊÄÅ
                button.disabled = false;
                button.innerHTML = translations[currentLang].register_button;
            }
        });
    </script>
</body>
</html>
